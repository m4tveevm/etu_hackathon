{% extends 'main.html' %}
{% block title %} Афиша Событий {% endblock %}

{% block content %}
{% load static %}
<!--    <link rel="stylesheet" type="text/css" href="style.css">-->

<div class="container">


    <div class="header pb-3 pt-3">
        <button class="home-btn btn btn-primary ms-3">Домой</button>
        <button class="login-btn btn btn-secondary me-3">Вход</button>

    </div>


    <div class="row">
        <button class="btn btn-primary full-width" data-bs-toggle="modal"
                data-bs-target="#filtersModal">Фильтры
        </button>
    </div>


    <div class="modal fade" id="filtersModal" tabindex="-1" aria-labelledby="filtersModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="filtersModalLabel">Фильтры</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Фильтр по максимальной стоимости -->
                    <div class="mb-3">
                        <label for="max-price" class="form-label">Максимальная цена:</label>
                        <input type="number" class="form-control" id="max-price" min="0" value="0">
                    </div>

                    <!-- Фильтр по району -->
                    <div class="mb-3">
                        <label class="form-label">Выбор района:</label>
                        <div id="area-popup" style="display: none;">
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Адмиралтейский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Василеостровский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Петроградский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Центральный
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Фрунзенский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Невский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Московский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Красногвардейский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Кировский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Колпинский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Красносельский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Кронштадтский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Курортный
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Петродворцовый
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Приморский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Пушкинский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Выборгский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Невский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Фрунзенский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Центральный
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Петроградский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Василеостровский
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> Адмиралтейский
                            </label>
                        </div>
                    </div>

                    <!-- Фильтр по категориям -->
                    <div class="mb-3">
                        <label class="form-label">Категории:</label>
                        <div id="category-popup" style="display: none;">
                            <!-- Пример для категории "События для бизнеса" -->
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none"> События для бизнеса
                            </label>

                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="business-events">
                                События для бизнеса
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="cinema">
                                Кинопоказы
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="concert">
                                Концерты
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="education">
                                Обучение
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="entertainment">
                                Развлечения
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="exhibition">
                                Выставки
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="fashion">
                                Мода и стиль
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="festival">
                                Фестивали
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="holiday">
                                Праздники
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category" value="kids">
                                Детям
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category" value="other">
                                Разное
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category" value="party">
                                Вечеринки
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category" value="photo">
                                Фотография
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category" value="quest">
                                Квесты
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="recreation">
                                Активный отдых
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="shopping">
                                Шопинг (Магазины)
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category"
                                       value="social-activity">
                                Благотворительность
                            </label>
                            <label class="btn btn-outline-secondary" onclick="toggleCheckbox(this)">
                                <input type="checkbox" class="d-none" name="category" value="stock">
                                Акции и скидки
                            </label>

                        </div>
                        <!-- Добавьте другие категории -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть
                    </button>
                    <button type="button" class="btn btn-primary" onclick="applyFilters()"
                            data-bs-dismiss="modal">
                        Применить фильтры
                    </button>
                </div>
            </div>
        </div>
    </div>


    <div class="main-content">
        <div class="row">
            <div class="event-grid d-flex justify-content-start flex-wrap">
                <div class="event card m-2" style="width: 30%;">
                    <img src="https://w.forfun.com/fetch/5d/5d572d697e41c82ac511549420ebcf44.jpeg"
                         class="card-img-top"
                         alt="Event 1">
                    <div class="card-body">
                        <h5 class="card-title">Название события 1</h5>
                        <p class="card-text">Стоимость: {coast}₽</p>
                        <p class="card-text">Время: 19:00</p>6
                        <p class="card-text">Место: Концертный зал</p>
                        <p class="card-text">Теги:</p>

                    </div>
                </div>


            </div>
        </div>

    </div>


    <div class="clear"></div>
    <div class="footer text-center p-4 mt-3">
        Авторские права Душнила, математик, информатик и прогматик
    </div>

    <script>
        function toggleAreaPopup() {
            var popup = document.getElementById("area-popup");
            popup.style.display = popup.style.display === 'none' ? 'block' : 'none';
        }

        function toggleCategoryPopup() {
            var popup = document.getElementById("category-popup");
            popup.style.display = popup.style.display === 'none' ? 'block' : 'none';
        }


    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        togglePopup('area-popup')
        togglePopup('category-popup')

        function togglePopup(popupId) {
            var popup = document.getElementById(popupId);
            var isDisplayed = popup.style.display === 'block';
            popup.style.display = isDisplayed ? 'none' : 'block';
        }

        function toggleCheckbox(label) {
            var checkbox = label.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;

            // Toggle button classes based on checkbox state
            if (checkbox.checked) {
                label.classList.remove('btn-outline-secondary');
                label.classList.add('btn-primary'); // Add primary class for checked
            } else {
                label.classList.remove('btn-primary');
                label.classList.add('btn-outline-secondary'); // Add secondary class for unchecked
            }

            // Call displaySelectedData function if necessary (optional)
            // displaySelectedData();
        }

        // You can call displaySelectedData() if needed elsewhere
        function displaySelectedData() {
            // ... existing code to collect and log selected data ...


            function applyFilters() {
                // Получить максимальную стоимость
                const maxPrice = document.getElementById('max-price').value;

                // Получить список выбранных районов
                const areaCheckboxes = document.querySelectorAll('#area-popup input[type="checkbox"]:checked');
                const selectedAreas = Array.from(areaCheckboxes).map(checkbox => checkbox.parentElement.textContent.trim());

                // Получить список выбранных категорий
                const categoryCheckboxes = document.querySelectorAll('#category-popup input[type="checkbox"]:checked');
                const selectedCategories = Array.from(categoryCheckboxes).map(checkbox => checkbox.name);

                // Формирование JSON объекта с фильтрами
                const filters = {
                    maxPrice: maxPrice,
                    areas: selectedAreas,
                    categories: selectedCategories
                };

                // Преобразование объекта в строку JSON для передачи или логирования
                const filtersJSON = JSON.stringify(filters);
                console.log(filtersJSON);

                // Вы можете посылать этот JSON на сервер или использовать по-своему
                // Здесь пример отправки данных на сервер (псевдокод)
                // fetch('/apply-filters', {
                //     method: "POST",
                //     body: filtersJSON,
                //     headers: {
                //         'Content-Type': 'application/json'
                //     }
                // }).then(response => response.json())
                //   .then(data => console.log(data))
                //   .catch(error => console.error('Error:', error));
            }

        }


    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</div>
{% endblock content %}